2025-07-21 22:52:39,780 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 22:52:39,780 - __main__ - INFO - Starting repayment analysis for source_data/repayment report.csv
2025-07-21 22:52:39,780 - __main__ - INFO - Loading repayment data from source_data\repayment report.csv
2025-07-21 22:52:40,313 - __main__ - ERROR - Error loading repayment data: Missing required columns after mapping: ['agent_id']
2025-07-21 22:52:40,313 - __main__ - ERROR - Error in analyze_repayments: Missing required columns after mapping: ['agent_id']
Traceback (most recent call last):
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 384, in analyze_repayments
    df = load_repayment_data(input_file)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 213, in load_repayment_data
    raise ValueError(f"Missing required columns after mapping: {missing_columns}")
ValueError: Missing required columns after mapping: ['agent_id']
2025-07-21 22:52:40,319 - __main__ - ERROR - An error occurred: Missing required columns after mapping: ['agent_id']
Traceback (most recent call last):
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 723, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 384, in analyze_repayments
    df = load_repayment_data(input_file)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 213, in load_repayment_data
    raise ValueError(f"Missing required columns after mapping: {missing_columns}")
ValueError: Missing required columns after mapping: ['agent_id']
2025-07-21 22:53:50,608 - __main__ - INFO - Starting repayment integration tests
2025-07-21 22:53:50,609 - __main__ - INFO - Testing analyze_repayments with direct DataFrame input
2025-07-21 22:53:50,613 - scripts.analysis.analyze_repayments - INFO - Starting repayment analysis for None
2025-07-21 22:53:50,613 - scripts.analysis.analyze_repayments - INFO - Using provided DataFrame
2025-07-21 22:53:50,631 - scripts.analysis.analyze_repayments - INFO - Data quality score: 1.00
2025-07-21 22:53:50,631 - scripts.analysis.analyze_repayments - INFO - Calculating agent metrics...
2025-07-21 22:53:50,663 - scripts.analysis.analyze_repayments - INFO - Analysis completed in 0.05 seconds
2025-07-21 22:53:50,663 - scripts.analysis.analyze_repayments - INFO - Analyzed 2 agents
2025-07-21 22:53:50,666 - __main__ - INFO - Direct DataFrame test passed!
2025-07-21 22:53:50,666 - __main__ - INFO - Direct DataFrame test results:
2025-07-21 22:53:50,676 - __main__ - INFO - Testing DataProcessor integration
2025-07-21 22:53:50,690 - scripts.data_processor - ERROR - Error in _get_agent_basic_info for agent A1001: 'NoneType' object has no attribute 'empty'
2025-07-21 22:53:50,690 - scripts.data_processor - INFO - Loading repayment data from: test_data\test_repayments.csv
2025-07-21 22:53:50,710 - scripts.analysis.analyze_repayments - INFO - Starting repayment analysis for None
2025-07-21 22:53:50,710 - scripts.analysis.analyze_repayments - INFO - Using provided DataFrame
2025-07-21 22:53:50,711 - scripts.analysis.analyze_repayments - ERROR - Error in analyze_repayments: name 'timedelta' is not defined
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 407, in analyze_repayments
    end_dt = pd.to_datetime(end_date) + timedelta(days=1)  # Include entire end day
                                        ^^^^^^^^^
NameError: name 'timedelta' is not defined
2025-07-21 22:53:50,714 - scripts.data_processor - ERROR - Error analyzing repayment data for agent A1001: name 'timedelta' is not defined
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\data_processor.py", line 255, in process_agent
    analysis_result = analyze_repayments(
                      ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 407, in analyze_repayments
    end_dt = pd.to_datetime(end_date) + timedelta(days=1)  # Include entire end day
                                        ^^^^^^^^^
NameError: name 'timedelta' is not defined
2025-07-21 22:53:50,716 - __main__ - INFO - Agent A1001 processed successfully. Score: 0.0
2025-07-21 22:53:50,717 - scripts.data_processor - ERROR - Error in _get_agent_basic_info for agent A1002: 'NoneType' object has no attribute 'empty'
2025-07-21 22:53:50,717 - scripts.data_processor - INFO - Loading repayment data from: test_data\test_repayments.csv
2025-07-21 22:53:50,721 - scripts.analysis.analyze_repayments - INFO - Starting repayment analysis for None
2025-07-21 22:53:50,721 - scripts.analysis.analyze_repayments - INFO - Using provided DataFrame
2025-07-21 22:53:50,722 - scripts.analysis.analyze_repayments - ERROR - Error in analyze_repayments: name 'timedelta' is not defined
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 407, in analyze_repayments
    end_dt = pd.to_datetime(end_date) + timedelta(days=1)  # Include entire end day
                                        ^^^^^^^^^
NameError: name 'timedelta' is not defined
2025-07-21 22:53:50,724 - scripts.data_processor - ERROR - Error analyzing repayment data for agent A1002: name 'timedelta' is not defined
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\data_processor.py", line 255, in process_agent
    analysis_result = analyze_repayments(
                      ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 407, in analyze_repayments
    end_dt = pd.to_datetime(end_date) + timedelta(days=1)  # Include entire end day
                                        ^^^^^^^^^
NameError: name 'timedelta' is not defined
2025-07-21 22:53:50,726 - __main__ - INFO - Agent A1002 processed successfully. Score: 0.0
2025-07-21 22:53:50,726 - __main__ - INFO - DataProcessor integration test passed!
2025-07-21 22:53:50,727 - __main__ - ERROR - Test failed: [WinError 145] The directory is not empty: 'test_data'
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\test_repayment_integration.py", line 111, in main
    test_data_processor_integration()
  File "D:\projects\Credit Risk\scripts\test_repayment_integration.py", line 98, in test_data_processor_integration
    test_dir.rmdir()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\pathlib.py", line 1351, in rmdir
    os.rmdir(self)
OSError: [WinError 145] The directory is not empty: 'test_data'
2025-07-21 22:57:06,031 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 22:57:06,032 - __main__ - INFO - Starting repayment analysis
2025-07-21 22:57:06,032 - __main__ - INFO - Input file: source_data/repayment report.csv
2025-07-21 22:57:06,032 - __main__ - INFO - Loading data from file: source_data/repayment report.csv
2025-07-21 22:57:06,032 - __main__ - INFO - Loading repayment data from source_data\repayment report.csv
2025-07-21 22:57:06,637 - __main__ - ERROR - Error loading repayment data: Missing required columns after mapping: ['agent_id']
2025-07-21 22:57:06,637 - __main__ - ERROR - Error in analyze_repayments: Missing required columns after mapping: ['agent_id']
Traceback (most recent call last):
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 400, in analyze_repayments
    df = load_repayment_data(input_file)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 213, in load_repayment_data
    raise ValueError(f"Missing required columns after mapping: {missing_columns}")
ValueError: Missing required columns after mapping: ['agent_id']
2025-07-21 22:57:06,639 - __main__ - ERROR - An error occurred: Missing required columns after mapping: ['agent_id']
Traceback (most recent call last):
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 773, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 400, in analyze_repayments
    df = load_repayment_data(input_file)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 213, in load_repayment_data
    raise ValueError(f"Missing required columns after mapping: {missing_columns}")
ValueError: Missing required columns after mapping: ['agent_id']
2025-07-21 22:59:16,647 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 22:59:16,647 - __main__ - INFO - Starting repayment analysis
2025-07-21 22:59:16,647 - __main__ - INFO - Input file: source_data/repayment report.csv
2025-07-21 22:59:16,647 - __main__ - INFO - Loading data from file: source_data/repayment report.csv
2025-07-21 22:59:16,647 - __main__ - INFO - Loading repayment data from source_data\repayment report.csv
2025-07-21 22:59:17,045 - __main__ - WARNING - Failed to parse dates for 349598 rows. First few: [NaT, NaT, NaT, NaT, NaT]
2025-07-21 22:59:17,575 - __main__ - INFO - Data quality score: 0.67
2025-07-21 22:59:17,575 - __main__ - INFO - Calculating agent metrics...
2025-07-21 22:59:17,690 - __main__ - INFO - Analysis completed in 1.04 seconds
2025-07-21 22:59:17,690 - __main__ - INFO - Analyzed 1715 agents
2025-07-21 22:59:17,775 - __main__ - INFO - Analysis report saved to reports\repayment_analysis_20250721_225917.csv
2025-07-21 23:00:08,050 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:00:08,051 - __main__ - INFO - Starting repayment analysis
2025-07-21 23:00:08,051 - __main__ - INFO - Input file: source_data/repayment report.csv
2025-07-21 23:00:08,051 - __main__ - INFO - Loading data from file: source_data/repayment report.csv
2025-07-21 23:00:08,051 - __main__ - INFO - Loading repayment data from source_data\repayment report.csv
2025-07-21 23:00:08,452 - __main__ - WARNING - Failed to parse dates for 349598 rows. First few: [NaT, NaT, NaT, NaT, NaT]
2025-07-21 23:00:08,453 - __main__ - INFO - Columns in input file: ['Bzid', 'Customer Repayment Date', 'Customer Repayment Amount', 'Customer Principle Repaid']
2025-07-21 23:00:08,453 - __main__ - INFO - Looking for source columns: ['Bzid', 'Customer Repayment Date', 'Customer Repayment Amount', 'Customer Principle Repaid']
2025-07-21 23:00:08,463 - __main__ - INFO - Successfully mapped columns. Mapped columns: ['agent_id', 'repayment_date', 'repayment_amount', 'principal_repaid']
2025-07-21 23:00:09,014 - __main__ - INFO - Data quality score: 0.67
2025-07-21 23:00:09,016 - __main__ - INFO - Calculating agent metrics...
2025-07-21 23:00:09,087 - __main__ - INFO - Analysis completed in 1.04 seconds
2025-07-21 23:00:09,091 - __main__ - INFO - Analyzed 1715 agents
2025-07-21 23:00:09,132 - __main__ - INFO - Analysis report saved to reports\repayment_analysis_20250721_230009.csv
2025-07-21 23:20:20,337 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:20:20,337 - __main__ - ERROR - An error occurred: name 'analyze_repayments' is not defined
Traceback (most recent call last):
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 527, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^
NameError: name 'analyze_repayments' is not defined
2025-07-21 23:21:57,091 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:21:57,092 - __main__ - INFO - Starting repayment analysis
2025-07-21 23:21:57,092 - __main__ - INFO - Loading data from file: source_data/repayment report.csv
2025-07-21 23:21:57,092 - __main__ - INFO - Loading repayment data from source_data\repayment report.csv
2025-07-21 23:21:57,489 - __main__ - WARNING - Failed to parse dates for 349598 rows. First few: [NaT, NaT, NaT, NaT, NaT]
2025-07-21 23:21:57,490 - __main__ - INFO - Columns in input file: ['Bzid', 'Customer Repayment Date', 'Customer Repayment Amount', 'Customer Principle Repaid']
2025-07-21 23:21:57,490 - __main__ - INFO - Looking for source columns: ['Bzid', 'Customer Repayment Date', 'Customer Repayment Amount', 'Customer Principle Repaid']
2025-07-21 23:21:57,501 - __main__ - INFO - Successfully mapped columns. Mapped columns: ['agent_id', 'repayment_date', 'repayment_amount', 'principal_repaid']
2025-07-21 23:21:58,007 - __main__ - INFO - Calculating agent metrics...
2025-07-21 23:21:58,041 - __main__ - INFO - Analysis complete. Processed 1715 agents.
2025-07-21 23:21:58,048 - __main__ - ERROR - Error in analyze_repayments: Bin labels must be one fewer than the number of bin edges
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 429, in analyze_repayments
    metrics['risk_category'] = pd.qcut(
                               ^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\reshape\tile.py", line 340, in qcut
    fac, bins = _bins_to_cuts(
                ^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\reshape\tile.py", line 493, in _bins_to_cuts
    raise ValueError(
ValueError: Bin labels must be one fewer than the number of bin edges
2025-07-21 23:21:58,068 - __main__ - ERROR - An error occurred: Bin labels must be one fewer than the number of bin edges
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 668, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 429, in analyze_repayments
    metrics['risk_category'] = pd.qcut(
                               ^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\reshape\tile.py", line 340, in qcut
    fac, bins = _bins_to_cuts(
                ^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\reshape\tile.py", line 493, in _bins_to_cuts
    raise ValueError(
ValueError: Bin labels must be one fewer than the number of bin edges
2025-07-21 23:23:45,794 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:23:45,794 - __main__ - INFO - Starting repayment analysis
2025-07-21 23:23:45,794 - __main__ - INFO - Loading data from file: source_data/repayment report.csv
2025-07-21 23:23:45,794 - __main__ - INFO - Loading repayment data from source_data\repayment report.csv
2025-07-21 23:23:46,155 - __main__ - WARNING - Failed to parse dates for 349598 rows. First few: [NaT, NaT, NaT, NaT, NaT]
2025-07-21 23:23:46,155 - __main__ - INFO - Columns in input file: ['Bzid', 'Customer Repayment Date', 'Customer Repayment Amount', 'Customer Principle Repaid']
2025-07-21 23:23:46,155 - __main__ - INFO - Looking for source columns: ['Bzid', 'Customer Repayment Date', 'Customer Repayment Amount', 'Customer Principle Repaid']
2025-07-21 23:23:46,165 - __main__ - INFO - Successfully mapped columns. Mapped columns: ['agent_id', 'repayment_date', 'repayment_amount', 'principal_repaid']
2025-07-21 23:23:46,639 - __main__ - INFO - Calculating agent metrics...
2025-07-21 23:23:46,666 - __main__ - INFO - Analysis complete. Processed 1715 agents.
2025-07-21 23:23:46,672 - __main__ - ERROR - Error in analyze_repayments: Bin labels must be one fewer than the number of bin edges
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 429, in analyze_repayments
    metrics['risk_category'] = pd.qcut(
                               ^^^^^^^^
  File "D:\projects\Credit Risk\.venv\Lib\site-packages\pandas\core\reshape\tile.py", line 340, in qcut
    fac, bins = _bins_to_cuts(
                ^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\.venv\Lib\site-packages\pandas\core\reshape\tile.py", line 493, in _bins_to_cuts
    raise ValueError(
ValueError: Bin labels must be one fewer than the number of bin edges
2025-07-21 23:23:46,672 - __main__ - ERROR - An error occurred: Bin labels must be one fewer than the number of bin edges
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 668, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 429, in analyze_repayments
    metrics['risk_category'] = pd.qcut(
                               ^^^^^^^^
  File "D:\projects\Credit Risk\.venv\Lib\site-packages\pandas\core\reshape\tile.py", line 340, in qcut
    fac, bins = _bins_to_cuts(
                ^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\.venv\Lib\site-packages\pandas\core\reshape\tile.py", line 493, in _bins_to_cuts
    raise ValueError(
ValueError: Bin labels must be one fewer than the number of bin edges
2025-07-21 23:24:56,949 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:24:56,949 - __main__ - INFO - Starting repayment analysis
2025-07-21 23:24:56,951 - __main__ - INFO - Loading data from file: source_data/repayment report.csv
2025-07-21 23:24:56,951 - __main__ - INFO - Loading repayment data from source_data\repayment report.csv
2025-07-21 23:24:57,309 - __main__ - WARNING - Failed to parse dates for 349598 rows. First few: [NaT, NaT, NaT, NaT, NaT]
2025-07-21 23:24:57,310 - __main__ - INFO - Columns in input file: ['Bzid', 'Customer Repayment Date', 'Customer Repayment Amount', 'Customer Principle Repaid']
2025-07-21 23:24:57,310 - __main__ - INFO - Looking for source columns: ['Bzid', 'Customer Repayment Date', 'Customer Repayment Amount', 'Customer Principle Repaid']
2025-07-21 23:24:57,321 - __main__ - INFO - Successfully mapped columns. Mapped columns: ['agent_id', 'repayment_date', 'repayment_amount', 'principal_repaid']
2025-07-21 23:24:57,886 - __main__ - INFO - Calculating agent metrics...
2025-07-21 23:24:57,915 - __main__ - INFO - Analysis complete. Processed 1715 agents.
2025-07-21 23:24:57,920 - __main__ - WARNING - Using equal-width binning for risk categories due to: Bin labels must be one fewer than the number of bin edges
2025-07-21 23:24:57,924 - __main__ - INFO - Analysis completed in 0.97 seconds
2025-07-21 23:24:57,924 - __main__ - INFO - Analyzed 1715 agents
2025-07-21 23:24:57,934 - __main__ - ERROR - An error occurred: 'NoneType' object has no attribute 'head'
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 697, in main
    print(formatted.head(args.top).to_string())
          ^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'head'
2025-07-21 23:27:40,996 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:27:40,996 - __main__ - ERROR - An error occurred: 'Namespace' object has no attribute 'output'
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 680, in main
    output_file=args.output,
                ^^^^^^^^^^^
AttributeError: 'Namespace' object has no attribute 'output'
2025-07-21 23:35:11,736 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:35:11,737 - __main__ - ERROR - An error occurred: analyze_repayments() missing 1 required positional argument: 'output_file'
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 728, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
TypeError: analyze_repayments() missing 1 required positional argument: 'output_file'
2025-07-21 23:36:23,090 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:36:23,090 - __main__ - ERROR - An error occurred: analyze_repayments() got an unexpected keyword argument 'df'
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 728, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
TypeError: analyze_repayments() got an unexpected keyword argument 'df'
2025-07-21 23:37:39,987 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:37:40,211 - __main__ - ERROR - An error occurred: 'repayment_amount'
Traceback (most recent call last):
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'repayment_amount'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 728, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 696, in analyze_repayments
    df['credit_health_score'] = df['repayment_amount'] / df['total_amount']
                                ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'repayment_amount'
2025-07-21 23:38:27,778 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:38:28,018 - __main__ - ERROR - An error occurred: 'repayment_amount'
Traceback (most recent call last):
  File "D:\projects\Credit Risk\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'repayment_amount'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 728, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "d:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 696, in analyze_repayments
    df['credit_health_score'] = df['repayment_amount'] / df['total_amount']
                                ~~^^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\.venv\Lib\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\.venv\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'repayment_amount'
2025-07-21 23:39:41,394 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:39:41,395 - __main__ - ERROR - An error occurred: analyze_repayments() got an unexpected keyword argument 'df'
Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 728, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
TypeError: analyze_repayments() got an unexpected keyword argument 'df'
2025-07-21 23:40:40,508 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:40:40,728 - __main__ - ERROR - An error occurred: 'repayment_amount'
Traceback (most recent call last):
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'repayment_amount'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 728, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 696, in analyze_repayments
    df['credit_health_score'] = df['repayment_amount'] / df['total_amount']
                                ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'repayment_amount'
2025-07-21 23:46:55,889 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:46:56,139 - __main__ - ERROR - An error occurred: 'repayment_amount'
Traceback (most recent call last):
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'repayment_amount'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 728, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 696, in analyze_repayments
    df['credit_health_score'] = df['repayment_amount'] / df['total_amount']
                                ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'repayment_amount'
2025-07-21 23:48:44,300 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:48:44,560 - __main__ - ERROR - An error occurred: 'repayment_amount'
Traceback (most recent call last):
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'repayment_amount'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 759, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 727, in analyze_repayments
    df['credit_health_score'] = df['repayment_amount'] / df['total_amount']
                                ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'repayment_amount'
2025-07-21 23:49:31,603 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:49:31,844 - __main__ - ERROR - An error occurred: 'repayment_amount'
Traceback (most recent call last):
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'repayment_amount'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 775, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 743, in analyze_repayments
    df['credit_health_score'] = df['repayment_amount'] / df['total_amount']
                                ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'repayment_amount'
2025-07-21 23:49:45,054 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:49:45,330 - __main__ - ERROR - An error occurred: 'repayment_amount'
Traceback (most recent call last):
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'repayment_amount'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 787, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 755, in analyze_repayments
    df['credit_health_score'] = df['repayment_amount'] / df['total_amount']
                                ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'repayment_amount'
2025-07-21 23:52:55,210 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:52:55,487 - __main__ - ERROR - An error occurred: 'repayment_amount'
Traceback (most recent call last):
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'repayment_amount'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 799, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 767, in analyze_repayments
    df['credit_health_score'] = df['repayment_amount'] / df['total_amount']
                                ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'repayment_amount'
2025-07-21 23:53:23,860 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:53:24,094 - __main__ - ERROR - An error occurred: 'repayment_amount'
Traceback (most recent call last):
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'repayment_amount'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 822, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 790, in analyze_repayments
    df['credit_health_score'] = df['repayment_amount'] / df['total_amount']
                                ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'repayment_amount'
2025-07-21 23:56:17,735 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:56:18,002 - __main__ - ERROR - An error occurred: 'repayment_amount'
Traceback (most recent call last):
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'repayment_amount'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 894, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 862, in analyze_repayments
    df['credit_health_score'] = df['repayment_amount'] / df['total_amount']
                                ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'repayment_amount'
2025-07-21 23:56:45,755 - __main__ - INFO - Starting repayment analysis with input: source_data/repayment report.csv
2025-07-21 23:56:46,069 - __main__ - ERROR - An error occurred: 'repayment_amount'
Traceback (most recent call last):
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'repayment_amount'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 894, in main
    result = analyze_repayments(
             ^^^^^^^^^^^^^^^^^^^
  File "D:\projects\Credit Risk\scripts\analysis\analyze_repayments.py", line 862, in analyze_repayments
    df['credit_health_score'] = df['repayment_amount'] / df['total_amount']
                                ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aswin\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'repayment_amount'
2025-07-22 00:28:40,811 - __main__ - INFO - Loading agent data with 0 rows...
2025-07-22 00:28:40,928 - __main__ - INFO - Loaded 1,915 agent records
2025-07-22 00:28:42,244 - __main__ - INFO - Loaded 13,913 sales records
2025-07-22 00:28:42,285 - __main__ - INFO - Merged data contains 1,915 agent records
2025-07-22 00:28:42,285 - __main__ - INFO - Data loading completed in 1.67 seconds
